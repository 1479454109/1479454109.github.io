import{d as a,g as e,m as l,p as t,x as s,o as u,c as o,w as r,a as n,b as c,e as d,n as i,u as v,t as f,B as m,G as p,R as _,T as h,k as b,h as k,i as y,f as g,I as C,U as x,V,W as T,X as w,D as j}from"./index-66b61406.js";import{h as L}from"./http.c8e1d22e.js";import{_ as U}from"./_plugin-vue_export-helper.1b428a4d.js";const I=U(a({__name:"profile",setup(a){const{safeAreaInsets:U}=e(),I=l({});t((async()=>{const a=await L({method:"GET",url:"/member/profile",data:{}});I.value=a.result}));const P=a=>{I.value.gender=a.detail.value},B=a=>{I.value.birthday=a.detail.value};let D=["","",""];const F=a=>{D=a.detail.code,I.value.fullLocation=a.detail.value.join(" ")},G=s(),J=async()=>{var a;console.log(I.value),console.log(D),await(a={nickname:I.value.nickname,gender:I.value.gender,birthday:I.value.birthday,profession:I.value.profession,provinceCode:D[0],cityCode:D[1],countyCode:D[2]},L({method:"PUT",url:"/member/profile",data:a})),G.profile.nickname=I.value.nickname,m({icon:"success",title:"保存成功"}),setTimeout((()=>{p()}),500)},N=()=>{_({count:1,mediaType:["image"],success:a=>{const e=a.tempFilePaths;h({url:"/member/profile/avatar",name:"file",filePath:e[0],success:a=>{200==a.statusCode?(console.log(JSON.parse(a.data)),I.value.avatar=JSON.parse(a.data).result.avatar,G.profile.avatar=I.value.avatar,m({icon:"success",title:"修改成功"})):m({icon:"error",title:"出现错误"})}})}})};return(a,e)=>{const l=b,t=k,s=y,m=g,p=C,_=x,h=V,L=T,D=w,G=j;return u(),o(t,{class:"viewport"},{default:r((()=>{var a;return[n(" 导航栏 "),c(t,{class:"navbar",style:i({paddingTop:(null==(a=v(U))?void 0:a.top)+"px"})},{default:r((()=>[c(l,{"open-type":"navigateBack",class:"back icon-left","hover-class":"none"}),c(t,{class:"title"},{default:r((()=>[d("个人信息")])),_:1})])),_:1},8,["style"]),n(" 头像 "),c(t,{class:"avatar"},{default:r((()=>[c(t,{class:"avatar-content"},{default:r((()=>{var a;return[c(s,{class:"image",src:null==(a=I.value)?void 0:a.avatar,mode:"aspectFill"},null,8,["src"]),c(m,{onClick:N,class:"text"},{default:r((()=>[d("点击修改头像")])),_:1})]})),_:1})])),_:1}),n(" 表单 "),c(t,{class:"form"},{default:r((()=>[n(" 表单内容 "),c(t,{class:"form-content"},{default:r((()=>[c(t,{class:"form-item"},{default:r((()=>[c(m,{class:"label"},{default:r((()=>[d("账号")])),_:1}),c(m,{class:"account"},{default:r((()=>{var a;return[d(f(null==(a=I.value)?void 0:a.account),1)]})),_:1})])),_:1}),c(t,{class:"form-item"},{default:r((()=>[c(m,{class:"label"},{default:r((()=>[d("昵称")])),_:1}),c(p,{class:"input",type:"text",placeholder:"请填写昵称",modelValue:I.value.nickname,"onUpdate:modelValue":e[0]||(e[0]=a=>I.value.nickname=a)},null,8,["modelValue"])])),_:1}),c(t,{class:"form-item"},{default:r((()=>[c(m,{class:"label"},{default:r((()=>[d("性别")])),_:1}),c(L,{onChange:P},{default:r((()=>[c(h,{class:"radio"},{default:r((()=>{var a;return[c(_,{value:"男",color:"#27ba9b",checked:"男"==(null==(a=I.value)?void 0:a.gender)},null,8,["checked"]),d(" 男 ")]})),_:1}),c(h,{class:"radio"},{default:r((()=>{var a;return[c(_,{value:"女",color:"#27ba9b",checked:"女"==(null==(a=I.value)?void 0:a.gender)},null,8,["checked"]),d(" 女 ")]})),_:1})])),_:1})])),_:1}),c(t,{class:"form-item"},{default:r((()=>{var a;return[c(m,{class:"label"},{default:r((()=>[d("生日")])),_:1}),c(D,{class:"picker",mode:"date",start:"1900-01-01",end:new Date,onChange:B,value:null==(a=I.value)?void 0:a.birthday},{default:r((()=>{var a;return[(null==(a=I.value)?void 0:a.birthday)?(u(),o(t,{key:0},{default:r((()=>{var a;return[d(f(null==(a=I.value)?void 0:a.birthday),1)]})),_:1})):(u(),o(t,{key:1,class:"placeholder"},{default:r((()=>[d("请选择日期")])),_:1}))]})),_:1},8,["end","value"])]})),_:1}),c(t,{class:"form-item"},{default:r((()=>{var a,e;return[c(m,{class:"label"},{default:r((()=>[d("城市")])),_:1}),c(D,{onChange:F,class:"picker",mode:"region",value:null==(e=null==(a=I.value)?void 0:a.fullLocation)?void 0:e.split(" ")},{default:r((()=>{var a;return[(null==(a=I.value)?void 0:a.fullLocation)?(u(),o(t,{key:0},{default:r((()=>{var a;return[d(f(null==(a=I.value)?void 0:a.fullLocation),1)]})),_:1})):(u(),o(t,{key:1,class:"placeholder"},{default:r((()=>[d("请选择城市")])),_:1}))]})),_:1},8,["value"])]})),_:1}),c(t,{class:"form-item"},{default:r((()=>[c(m,{class:"label"},{default:r((()=>[d("职业")])),_:1}),c(p,{class:"input",type:"text",placeholder:"请填写职业",modelValue:I.value.profession,"onUpdate:modelValue":e[1]||(e[1]=a=>I.value.profession=a)},null,8,["modelValue"])])),_:1})])),_:1}),n(" 提交按钮 "),c(G,{onClick:J,class:"form-button"},{default:r((()=>[d("保 存")])),_:1})])),_:1})]})),_:1})}}}),[["__scopeId","data-v-0e02ac85"]]);export{I as default};
