import{d as e,g as a,m as l,o as t,j as s,a as r,b as u,w as i,F as o,r as n,c as d,e as c,t as v,u as f,n as m,E as p,B as _,f as y,h as S,i as g,k as h,v as k,aa as b,l as C,S as x}from"./index-66b61406.js";import{h as w,f as O,e as j}from"./order.b9fd0a73.js";import{a as D,O as I}from"./constants.0bd4826e.js";import"./http.c8e1d22e.js";import{_ as F}from"./_plugin-vue_export-helper.1b428a4d.js";const H=F(e({__name:"OrderList",props:{orderState:null},setup(e,{expose:b}){const C=e,{safeAreaInsets:x}=a(),F=l(),H=l(1);let M=l(!0);const B=async()=>{const e=await w({page:H.value,pageSize:5,orderState:C.orderState});F.value&&F.value.items?F.value.items&&F.value.items.length>0&&F.value.items.push(...e.result.items):F.value=e.result,M.value=e.result.pages>H.value},J=()=>{M.value&&(H.value=H.value+1,B())},L=l(!1),P=async()=>{H.value=1,F.value={},L.value=!0,await B(),L.value=!1};return b({getMemberOrder:B,onrefresherrefresh:P}),(e,a)=>{const l=y,b=S,w=g,H=h,B=k;return t(),s(o,null,[r(" 订单列表 "),u(B,{"refresher-enabled":"",onRefresherrefresh:P,onScrolltolower:J,"refresher-triggered":L.value,"scroll-y":"",class:"orders"},{default:i((()=>{var e,a;return[(t(!0),s(o,null,n(null==(e=F.value)?void 0:e.items,(e=>(t(),d(b,{class:"card",key:null==e?void 0:e.id},{default:i((()=>[r(" 订单信息 "),u(b,{class:"status"},{default:i((()=>{var a,s,o;return[u(l,{class:"date"},{default:i((()=>[c(v(e.createTime),1)])),_:2},1024),r(" 订单状态文字 "),u(l,null,{default:i((()=>[c(v(f(D)[e.orderState].text),1)])),_:2},1024),r(" 待评价/已完成/已取消 状态: 展示删除订单 "),[null==(a=f(I))?void 0:a.DaiPingJia,null==(s=f(I))?void 0:s.YiWanCheng,null==(o=f(I))?void 0:o.YiQuXiao].includes(null==e?void 0:e.orderState)?(t(),d(l,{key:0,onClick:a=>(async e=>{p({content:"为保障您的权益，请收到货并确认无误后，再确认收货",success:async a=>{var l;a.confirm&&(await O({ids:[e]}),_({icon:"success",title:"删除成功"}),F.value.items=null==(l=F.value)?void 0:l.items.filter((a=>a.id!=e)))}})})(null==e?void 0:e.id),class:"icon-delete"},null,8,["onClick"])):r("v-if",!0)]})),_:2},1024),r(" 商品信息，点击商品跳转到订单详情，不是商品详情 "),(t(!0),s(o,null,n(null==e?void 0:e.skus,((a,l)=>(t(),d(H,{key:l,class:"goods",url:`/pagesOrder/detail/detail?id=${null==e?void 0:e.id}`,"hover-class":"none"},{default:i((()=>[u(b,{class:"cover"},{default:i((()=>[u(w,{mode:"aspectFit",src:null==a?void 0:a.image},null,8,["src"])])),_:2},1024),u(b,{class:"meta"},{default:i((()=>[u(b,{class:"name ellipsis"},{default:i((()=>[c(v(a.name),1)])),_:2},1024),u(b,{class:"type"},{default:i((()=>[c(v(a.attrsText),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])))),128)),r(" 支付信息 "),u(b,{class:"payment"},{default:i((()=>[u(l,{class:"quantity"},{default:i((()=>{var a;return[c("共"+v(null==(a=null==e?void 0:e.skus)?void 0:a.length)+"件商品",1)]})),_:2},1024),u(l,null,{default:i((()=>[c("实付")])),_:1}),u(l,{class:"amount"},{default:i((()=>[u(l,{class:"symbol"},{default:i((()=>[c("¥")])),_:1}),c(v(e.payMoney),1)])),_:2},1024)])),_:2},1024),r(" 订单操作按钮 "),u(b,{class:"action"},{default:i((()=>{var a;return[r(" 待付款状态：显示去支付按钮 "),e.orderState==f(I).DaiFuKuan?(t(),d(b,{key:0,onClick:a=>(async e=>{_({icon:"success",title:"支付成功"}),F.value.items.find((a=>a.id==e)).orderState=I.DaiFaHuo})(null==e?void 0:e.id),class:"button primary"},{default:i((()=>[c("去支付")])),_:2},1032,["onClick"])):(t(),s(o,{key:1},[u(H,{class:"button secondary",url:`/pagesOrder/create/create?orderId=${null==e?void 0:e.id}`,"hover-class":"none"},{default:i((()=>[c(" 再次购买 ")])),_:2},1032,["url"]),r(" 待收货状态: 展示确认收货 "),(null==e?void 0:e.orderState)==(null==(a=f(I))?void 0:a.DaiShouHuo)?(t(),d(b,{key:0,onClick:a=>{return l=null==e?void 0:e.id,void p({content:"为保障您的权益，请收到货并确认无误后，再确认收货",success:async e=>{var a;e.confirm&&(await j(l),_({icon:"success",title:"已收货"}),C.orderState==I.DaiShouHuo?F.value.items=null==(a=F.value)?void 0:a.items.filter((e=>e.id!=l)):F.value.items.find((e=>e.id==l)).orderState=I.DaiPingJia)}});var l},class:"button primary"},{default:i((()=>[c("确认收货")])),_:2},1032,["onClick"])):r("v-if",!0)],64))]})),_:2},1024)])),_:2},1024)))),128)),r(" 底部提示文字 "),u(b,{class:"loading-text",style:m({paddingBottom:(null==(a=f(x))?void 0:a.bottom)+"px"})},{default:i((()=>[c(v(f(M)?"正在加载...":"没有更多数据~"),1)])),_:1},8,["style"])]})),_:1},8,["refresher-triggered"])],2112)}}}),[["__scopeId","data-v-9992ffc4"]]),M=F(e({__name:"list",props:{type:null},setup(e){const a=e,f=l([{orderState:0,title:"全部"},{orderState:1,title:"待付款"},{orderState:2,title:"待发货"},{orderState:3,title:"待收货"},{orderState:4,title:"待评价"}]),p=l(f.value.findIndex((e=>e.orderState===Number(a.type)))),_=l(),g=e=>{p.value=e.detail.current,_.value[p.value].onrefresherrefresh()};return b((()=>{_.value[p.value].getMemberOrder()})),(e,a)=>{const l=y,h=S,k=x,b=C;return t(),d(h,{class:"viewport"},{default:i((()=>[r(" tabs "),u(h,{class:"tabs"},{default:i((()=>[(t(!0),s(o,null,n(f.value,((e,a)=>(t(),d(l,{onClick:e=>p.value=a,class:"item",key:a},{default:i((()=>[c(v(e.title),1)])),_:2},1032,["onClick"])))),128)),r(" 游标 "),u(h,{class:"cursor",style:m({left:20*p.value+"%"})},null,8,["style"])])),_:1}),r(" 滑动容器 "),u(b,{current:p.value,class:"swiper",onChange:g},{default:i((()=>[r(" 滑动项 "),(t(!0),s(o,null,n(f.value,((e,a)=>(t(),d(k,{key:a},{default:i((()=>[u(H,{ref_for:!0,ref_key:"OrderListRef",ref:_,orderState:null==e?void 0:e.orderState},null,8,["orderState"])])),_:2},1024)))),128))])),_:1},8,["current"])])),_:1})}}}),[["__scopeId","data-v-55fce615"]]);export{M as default};
